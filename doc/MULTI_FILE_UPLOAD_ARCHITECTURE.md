# ????????????? ?????????

## ??

?????????????????????????????????????????Web Worker????????????????????????

## ????

### ?????
- **????????????????**: `FileUpload.tsx`?1??????????
- **????**: ????????UI????????
- **???????**: ??????????????
- **?????????**: ???????????

### ??
1. ????????????????????
2. ????????????????UI??????????
3. ????????????????
4. ?????????????

## ????

1. **?????????**: ????????????????
2. **????????????**: ?????????????????
3. **Web Worker??**: ???????????UI????????
4. **????**: ??????????????????
5. **?????????**: ????????????

## ?????????

### ????

```
???????????????????????????????????????????????????????????
?                     React UI Layer                       ?
?  ????????????????????????????????????????????????????   ?
?  ?  FileUpload Component (Multi-file selector)       ?   ?
?  ??????????????????????????????????????????????????????   ?
?                    ?                                       ?
?  ??????????????????????????????????????????????????????   ?
?  ?  UploadQueue Manager (Context/Hook)                ?   ?
?  ?  - Queue state management                          ?   ?
?  ?  - Task status tracking                            ?   ?
?  ?  - Progress updates                                ?   ?
?  ??????????????????????????????????????????????????????   ?
?                    ?                                       ?
??????????????????????????????????????????????????????????????
                     ?
??????????????????????????????????????????????????????????????
?                  Web Worker Layer                          ?
?  ????????????????????????????????????????????????????     ?
?  ?  upload-worker.ts                                ?     ?
?  ?  - File upload processing                        ?     ?
?  ?  - Progress reporting                            ?     ?
?  ?  - Error handling                                ?     ?
?  ??????????????????????????????????????????????????????     ?
??????????????????????????????????????????????????????????????
                     ?
??????????????????????????????????????????????????????????????
?                  Service Layer                              ?
?  ????????????????????????????????????????????????????     ?
?  ?  grpcService.ts (existing)                       ?     ?
?  ?  - uploadFileService()                           ?     ?
?  ????????????????????????????????????????????????????     ?
??????????????????????????????????????????????????????????????
```

## ????

### ??1: ?????????????????

**??**: ???????????????????

**????**:
1. `FileUpload.tsx`: ?????????????`multiple`???
2. `useFileUpload.ts`: ???????????
3. `types.ts`: ????????????

**??????**:
- `webapp/src/components/FileUpload.tsx`
- `webapp/src/hooks/useFileUpload.ts`
- `webapp/src/types.ts`

**??**:
- ???????????&??????
- ????????????
- ?????????1????

### ??2: ????????????

**??**: ????????????????????

**????**:
1. `UploadQueue` Context/Provider: ?????????????
2. `useUploadQueue` Hook: ????????????
3. `UploadQueueView` Component: ?????????
4. ???????: pending, uploading, success, error, cancelled

**??????**:
- `webapp/src/contexts/UploadQueueContext.tsx`
- `webapp/src/hooks/useUploadQueue.ts`
- `webapp/src/components/UploadQueueView.tsx`

**??????**:
- `webapp/src/components/FileUpload.tsx`
- `webapp/src/types.ts`

**??**:
- ??????????
- ?????????pending ? uploading ? success/error?
- ??????????????
- ???????
- ????????

### ??3: Web Worker??

**??**: ???????????UI????????

**????**:
1. `upload-worker.ts`: Web Worker???
2. Worker?????????????????
3. ????????
4. ?????????

**??????**:
- `webapp/src/workers/upload-worker.ts`
- `webapp/public/upload-worker.js` (???????)

**??????**:
- `webapp/src/hooks/useUploadQueue.ts`
- `webapp/src/components/FileUpload.tsx`

**??**:
- ??????????????????
- ???????????
- ??????????????????
- UI??????

## ?????

### ?????????

```typescript
interface UploadTask {
  id: string;                    // ??????ID
  file: File;                    // ????????????
  storageProvider: string;       // ??????????
  status: 'pending' | 'uploading' | 'success' | 'error' | 'cancelled';
  progress: number;              // 0-100
  error?: string;                // ????????
  result?: FileUploadStatus;     // ????????
  createdAt: number;             // ???????
  startedAt?: number;            // ??????????
  completedAt?: number;          // ????
}
```

### ?????

```typescript
interface UploadQueueState {
  tasks: UploadTask[];
  activeTaskId: string | null;   // ?????????????ID
  maxConcurrent: number;           // ?????????????????
}
```

## UI??

### ?????????
- ???????????&??????
- ????????????
- ??????????????????

### ????????
- ??????????pending, uploading, success, error?
- ???????
- ????????
- ????????????

### ????
- ?????: X/Y ??????
- ?????????: ?????????????

## ???????

### Web Worker??
- DOM API?????????
- `fetch` API?????
- ???????????? `postMessage` / `onmessage`

### ?????
- ??????????????????????
- ??????????????????

### ?????????
- ?????????
- ???????
- ?????????
- ????????????????

## ?????

1. **????????**: ???????????????
2. **??????**: ??????????
3. **????/??**: ??????????????
4. **??????????**: ????????????????
5. **???????**: ????????????????????????

## ?????????

### ??1
- [ ] `FileUpload.tsx`???????????
- [ ] `useFileUpload.ts`?????????
- [ ] ????????
- [ ] ????&?????????????

### ??2
- [ ] `UploadQueueContext`???
- [ ] `useUploadQueue` Hook???
- [ ] `UploadQueueView` Component???
- [ ] ??????????

### ??3
- [ ] `upload-worker.ts`???
- [ ] Worker?????????
- [ ] ???????
- [ ] ?????????

## ????

- ???????????????????????????
- ??????API?????????`uploadFileService`????
- ???????????????????????
